let page;const system_events={body_left_show:e=>{const t=document.querySelector("section.system-block-body-left");null!=t&&(t.dataset.show=parseInt(t.dataset.show)?0:1)},body_left_type:e=>{const t=document.querySelector("section.system-block-body-left");if(null==t)return;const a=parseInt(t.dataset.min);t.dataset.min=a?0:1,addCookie("is_body_left_min",a?0:1)},tab_show:function(e){const t=e.target,a=t.parentElement,n=parseInt(t.dataset.show);null!=a.querySelector("a[data-selected='1']")&&(isNaN(n)||n)?this.dataset.show=0:this.dataset.show=n?0:1}};function addCookie(e="",t,a){if("string"!=typeof(e=String(e).trim())||e.length<1||null==t)return;e=encodeURIComponent(e),a=1e3*("number"==typeof a?a:3600);const n=Date.now(),r=new Date(n+a);return t=encodeURIComponent("object"==typeof t?JSON.stringify(t).trim():String(t).trim()),document.cookie=`${e}=${t}; expires=${r.toUTCString()}; path=/`,document.cookie}function addEvent(e={}){let t;if("object"==typeof e&&e.hasOwnProperty("dom")){t=e.dom;for(const a of Object.keys(e))"dom"!==a&&(t[a]=t=>e[a](t));return t}}const regexCssClass=/\.([\w_-]+)?/gi,regexCssID=/\#([\w_-]+)?/i,regexCssTag=/^\w+(?=[\#\.]*)/i;function createElement(e="",t,a){const n=((e.match(regexCssTag)||[])[0]||"").trim(),r=((e.match(regexCssID)||[])[1]||"").trim(),l=(regexCssClass.test(e)?e.match(regexCssClass):[]).map((e=>e.replace(/^\./,"")));if(n.length<1)return;let s,o,u="temp"===e,c=u?document.createDocumentFragment():document.createElement(n);r.length>0&&(c.id=r);for(const e of l)c.classList.add(e);if(null==t&&null!=a&&([t,a]=[a,null]),null!=t&&null!=a)[s,o]=[t,a];else if(null==a)"string"==typeof t||"number"==typeof t||Array.isArray(t)?o=t:s=t;else if(null==t)return c;return(()=>{if("object"==typeof s&&null!=s)for(const e in s){if(!s.hasOwnProperty(e))continue;const t=s[e];if({value:1,innerText:1,innerHTML:1,textContent:1,contentEditable:1,selected:1,checked:1}[e])c[e]=t;else if({valuedisplay:1,valuecolor:1,valuebackgroundColor:1,valuebackground:1,valuewidth:1,valueheight:1,valuefloat:1}[e])c.style[e]=t;else if("dataset"===e&&"object"==typeof t)for(const e of Object.keys(t))c.dataset[e]=t[e];else null!=t&&c.setAttribute(e,t)}})(),(()=>{if(null==o)return;const e="object"==typeof o;if(Array.isArray(o)){for(let e of o){const t=e instanceof Element;"string"==typeof e||"number"==typeof e?u?c.appendChild(document.createTextNode(e)):c.innerHTML+=e:t&&c.appendChild(e)}return}if(e)return;const t=o,a="input"===n,r="textarea"===n;"img"===n||"source"===n?c[_src]=t:r||a?c.value=t:u?c.appendChild(document.createTextNode(o)):c.innerHTML=t})(),c}function decodeFromSafeBase64(e){const t=e.replace(/[-_]/g,(e=>"-"===e?"+":"/")),a=t.length%4;e=t+(a?"=".repeat(4-a):"");const n=atob(e),r=new Uint8Array([...n].map((e=>e.charCodeAt(0)))),l=(new TextDecoder).decode(r);return JSON.parse(l)}function encodeToSafeBase64(e){const t=JSON.stringify(e),a=(new TextEncoder).encode(t);return btoa(String.fromCharCode(...a)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function getCookie(e=""){if("string"!=typeof(e=String(e).trim())||e.length<1)return;const t=new RegExp(e+"=([^ ;]+)?"),a=document.cookie.match(t)||[],n=a.length;let r=a[n-1];if(!(n<1||null==r)){r=decodeURIComponent(r);try{return JSON.parse(r)}catch(e){return r}}}let textInputErrorTimer;function textInput(e){const t=e.target,a=t.parentElement.parentElement,n=t.dataset.type??t.type??"text",r=t.dataset.wrap??"1",l=t.dataset.force??"1",s=!("0"===r),o=/\n/.test(t.value),u="1"===l;let c=t.dataset.max,i=t.dataset.min;switch(n){case"text":!s&&o&&(t.value=t.value.replace(/\n/g,""),a.dataset.error=1,clearTimeout(textInputErrorTimer),textInputErrorTimer=setTimeout((e=>{a.dataset.error=0}),1e3));break;case"account":var d=/[^\w]/g;u&&(t.value=t.value.replace(/\s/g,"").replace(d,""));const e=d.test(t.value);a.dataset.error=e?1:0,a.dataset.message=e?"僅接受半形英文 / 數字 / 底線":"";break;case"number":d=/[^\d\-\.]/g;(u||c||i)&&(t.value=t.value.replace(/\s/g,"").replace(d,"")),a.dataset.error=d.test(t.value)?1:0;break;case"email":(d=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/).test(t.value)||(a.dataset.error=1,a.dataset.message="內容不符合EMAIL格式.",clearTimeout(textInputErrorTimer),textInputErrorTimer=setTimeout((e=>{a.dataset.error=0,a.dataset.message=""}),1e3));break;case"password":d=/[^\w\!\"\#\$\%\&\'\(\)\*\+\,\-\.\/\:\;\<\=\>\?\@\[\\\]\^\`\{\|\}\~\ ]/;u&&(t.value=t.value.replace(/\s/g,"").replace(d,"")),a.dataset.error=d.test(t.value)?1:0,a.dataset.message=d.test(t.value)?"內容包含不支持的字符.":""}if(null!=c||null!=i){if(c=isNaN(c)?null:parseFloat(c),i=isNaN(i)?null:parseFloat(i),"number"===n){if(/^\-/.test(t.value)&&1===t.value.length||/\.$/.test(t.value)||t.value.length<1)return;t.value=Math.max(i,Math.min(c,parseFloat(t.value)))}else{null!=c&&t.value.length>c&&(t.value=t.value.slice(0,c));var m=null!=i&&t.value.length;"1"===a.dataset.error&&m?a.dataset.message=a.dataset.message+(t.value.length<i?" / 最小長度為 "+i:""):m&&(a.dataset.error=t.value.length<i?1:0,a.dataset.message=t.value.length<i?"最小長度為 "+i:"")}"TEXTAREA"===t.tagName&&null!=t.nextElementSibling&&(t.nextElementSibling.innerHTML=t.value.replace(/\n/g,"<br>"))}}const hasgtagKeyup=e=>{if("Enter"!==e.key)return;const t=e.target;let a=(t.value||"").match(/[#＃\,，\n\ ]+([\w\u4e00-\u9fa5\u3105-\u3129\u31A0-\u31B7\u3040-\u30FF\u3130-\u318F\uAC00-\uD7AF]+)/g)||t.value.split(/\s/),n=new Map;if(a.length<1)return;for(let e=0,t=a[e];e<a.length;e++,t=a[e]){const e=t.replace(/[#＃\,，\n\ ]/g,"").slice(0,24);e.length<2||n.set(e,0)}let r=Array.from(n.keys());r.length>0?(t.value=`#${r.join(" #")} #`.trim(),t.nextElementSibling.innerHTML=t.value.replace(/\n/g,"<br>")):(t.value="#",t.nextElementSibling.innerHTML="#")};